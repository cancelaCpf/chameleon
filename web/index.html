<!DOCTYPE html>
<html>
    <head>
        <title>Chameleon</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style/style.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc" crossorigin="anonymous">
    </head>
    <body>
        <main>
            <header>
                    <a href="#" id="open-menu"><i class="fas fa-bars"></i></a>
                    <div class="logo-align">
                        <img id="logo" src="assets/img/logo.gif" alt="logo">
                        <h1 id="brand">Chameleon Convert</h1>
                    </div>
            </header>
            <nav id="navbar">
                <a id="close-menu" href="#"><i class="fas fa-times"></i></a>
                <div id="search">
                    <input id="search-type" type="search" placeholder="Search types">
                    <button id="btn-search"><i class="fas fa-search"></i></button>
                </div>
                <div id="group-types">
                    <a href="#">Temperature</a>
                    <a href="#">Finance</a>
                    <a href="#">Length</a>
                </div>
            </nav>
            <section id="conversor">
                <form id="conversor-form">
                    <h2>Convert your value</h2>
                    <label for="init-value">Value</label>
                    <input id="init-value" name="initValue" type="number" placeholder="Enter the value here" required>
                    <label for="unitFrom">From</label>
                    <select id="unitFrom">
                        <optgroup label="temperature">
                            <option value="0-1">celsius</option>
                            <option value="0-2">fahrenheit</option>
                        </optgroup>
                        <optgroup label="metric">
                            <option value="3-4">centimeters</option>
                            <option value="3-5">meters</option>
                        </optgroup>
                    </select>
                    <label for="unitTo">To</label>
                    <select id="unitTo">
                        <optgroup label="temperature">
                            <option value="0-2">fahrenheit</option>
                            <option value="0-1">celsius</option>
                        </optgroup>
                        <optgroup label="metric">
                            <option value="3-5">meters</option>
                            <option value="3-4">centimeters</option>
                        </optgroup>
                    </select>
                    <button id="convert" class="button">Convert</button>
                </form>
            </section>
            <section id="result-board">
                <h2><span id="from-value">0 ºC</span> converted is...</h2>
                <p id="to-value">0 ºF</p>
            </section>
            <footer>
                <p>&copy; Chameleon - 2020</p>
            </footer>
            <script src="js/temperature/degrees.js">
            </script>
            <script>
                const btnOpenMenu = document.querySelector("#open-menu");
                const btnCloseMenu = document.querySelector("#close-menu");
                const navbar = document.querySelector("#navbar");

                btnOpenMenu.onclick = (e) => {
                    e.preventDefault();
                    navbar.style.display = "initial";
                    navbar.style.animation = "show-menu 0.5s"
                }

                btnCloseMenu.onclick = (e) => {
                    e.preventDefault();
                    navbar.style.animation = "hide-menu 0.5s"
                    setTimeout(() => {
                        navbar.style.display = "none";
                    }, 500);
                    // navbar.style.display = "none";
                }

                document.querySelector('#conversor-form').onsubmit = (e) => { e.preventDefault()};
                const validate = () => {
                    const unitFrom = document.querySelector("#unitFrom");
                    const unitTo = document.querySelector("#unitTo");
                    const valueFrom = document.querySelector("#init-value")
                    const [unitFromParent, unitFromId] = unitFrom.value.split("-");
                    const [unitToParent, unitToId] = unitTo.value.split("-");
                    console.log(unitFromId, unitToId);
                    
                    console.log(valueFrom.value);
                    if(valueFrom.value === "") {
                        valueFrom.setCustomValidity("You must enter a value!");
                        valueFrom.reportValidity();
                        return false;
                    }

                    if (unitFromParent !== unitToParent) {
                        unitTo.setCustomValidity("The units must be the from the same group");
                        unitTo.reportValidity();
                        return false;
                    }

                    if (unitFromId === unitToId) {
                        unitTo.setCustomValidity("The units can't be the same");
                        unitTo.reportValidity();
                        return false;
                    }

                    valueFrom.setCustomValidity("");
                    unitFrom.setCustomValidity("");
                    unitTo.setCustomValidity("");
                    return true;
                }
                const convert = (e) => {
                    if(!validate()) return false;
                    
                    const idBoard = '#result-board';
                    const resultBoard = document.querySelector(idBoard);
                    resultBoard.style.display = 'flex';
                    window.location.href = `${idBoard}`;

                    const valueFrom = document.querySelector("#init-value");
                    const convertedValue = celsiusToFahrenheit(valueFrom.value);

                    document.querySelector('#from-value').innerHTML = `${valueFrom.value} ºC`;
                    document.querySelector('#to-value').innerHTML = `${convertedValue} ºF`;
                }

                document.querySelector('#convert').onclick = convert;
            </script>
        </main>
    </body>
</html>